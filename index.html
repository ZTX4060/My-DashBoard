<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>الجدول الأسبوعي + Task Manager</title>

  <!-- Poppins font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0b0d;
      --card:#0f1113;
      --muted:#98a0a6;
      --accent:#1f2933;
      --glass: rgba(255,255,255,0.03);
      --text:#e6eef3;
      --accent-2:#111317;
      --success: #17a34a;
      --danger: #d73a3a;
      font-family: 'Poppins', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    *{box-sizing:border-box}
    html,body{
      height:100%;
      margin:0;
      background: linear-gradient(180deg, var(--bg), #060606 120%);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      font-size:16px;
      line-height:1.4;
    }

    /* NAVBAR */
    .nav {
      width:100%;
      backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-bottom: 1px solid rgba(255,255,255,0.03);
      position:sticky;
      top:0;
      z-index:40;
      padding:10px 16px;
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:12px;
    }
    .nav .nav-buttons{ display:flex; gap:10px; }
    .btn {
      background:var(--card);
      color:var(--text);
      border:1px solid rgba(255,255,255,0.03);
      padding:10px 14px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      font-size:15px;
      min-width:110px;
      text-align:center;
    }
    .btn.secondary{ background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted); font-weight:600; }
    .btn.active{ outline:2px solid rgba(255,255,255,0.04); background:linear-gradient(180deg,#131416,#0e1012); color:var(--text); }

    .container {
      max-width:1100px;
      margin:22px auto;
      padding:18px;
    }

    /* header area */
    .header {
      display:flex;
      gap:18px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:18px;
    }
    .header .title {
      font-size:22px;
      font-weight:700;
      letter-spacing:0.2px;
    }
    .header .sub {
      color:var(--muted);
      font-size:14px;
    }

    /* layout */
    .layout {
      display:grid;
      grid-template-columns: 1fr 380px;
      gap:18px;
    }

    /* main cards area */
    .day-panel {
      background:var(--card);
      border-radius:14px;
      padding:16px;
      border:1px solid rgba(255,255,255,0.03);
    }

    .day-switch {
      display:flex;
      gap:8px;
      margin-bottom:12px;
      flex-wrap:wrap;
    }
    .day-pill {
      padding:8px 10px;
      background:transparent;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.02);
      color:var(--muted);
      cursor:pointer;
      font-weight:600;
      font-size:14px;
    }
    .day-pill.current { background:var(--accent); color:var(--text); border:1px solid rgba(255,255,255,0.04); }

    .cards-grid {
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:12px;
    }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      border-radius:12px;
      padding:14px;
      min-height:80px;
    }
    .card h3 {
      margin:0 0 6px 0;
      font-size:16px;
      font-weight:700;
    }
    .card p {
      margin:0;
      color:var(--muted);
      font-size:14px;
    }
    .card .time {
      float:left;
      font-weight:600;
      color:var(--text);
      font-size:15px;
    }

    /* prayer area spanning full width */
    .prayer-card {
      grid-column: 1 / -1;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .prayer-list {
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .prayer-item {
      background:var(--accent-2);
      padding:12px;
      border-radius:10px;
      min-width:110px;
      text-align:center;
      border:1px solid rgba(255,255,255,0.02);
    }
    .prayer-item .name { font-weight:600; font-size:14px; color:var(--muted); }
    .prayer-item .val { font-weight:700; font-size:16px; color:var(--text); margin-top:6px; display:block; }

    /* side - task manager */
    .side {
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .tasks {
      background:var(--card);
      border-radius:12px;
      padding:12px;
      border:1px solid rgba(255,255,255,0.03);
    }
    .tasks h4 { margin:0 0 8px 0; font-size:16px; }
    .task-input {
      display:flex;
      gap:8px;
    }
    .task-input input {
      flex:1;
      padding:10px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.04);
      background:transparent;
      color:var(--text);
      font-size:14px;
    }
    .task-list { margin-top:10px; display:flex; flex-direction:column; gap:8px; max-height:380px; overflow:auto; padding-right:6px; }
    .task-item {
      background:var(--accent-2);
      padding:10px;
      border-radius:8px;
      display:flex;
      gap:8px;
      align-items:center;
      justify-content:space-between;
      border:1px solid rgba(255,255,255,0.02);
    }
    .task-item .left { display:flex; gap:8px; align-items:center; }
    .task-item input[type="checkbox"]{ width:18px; height:18px; }
    .task-item .text { font-weight:600; color:var(--text); }
    .task-item .meta { color:var(--muted); font-size:13px; }
    .task-actions { display:flex; gap:8px; }
    .small-btn {
      padding:6px 8px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.03);
      background:transparent;
      color:var(--muted);
      cursor:pointer;
      font-weight:600;
      font-size:13px;
    }

    /* empty state */
    .empty { color:var(--muted); font-size:14px; text-align:center; padding:18px 8px; }

    /* responsive */
    @media (max-width:980px){
      .layout { grid-template-columns: 1fr; }
      .cards-grid { grid-template-columns: 1fr; }
      .prayer-card { flex-direction:column; align-items:flex-start; gap:8px; }
    }

    /* small polish */
    ::-webkit-scrollbar { height:8px; width:8px; }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.03); border-radius:8px; }
    .muted { color:var(--muted); font-size:13px; }

  </style>
</head>
<body>

  <nav class="nav">
    <div class="nav-buttons" role="navigation" aria-label="nav">
      <button id="showSchedule" class="btn active">جدول</button>
      <button id="showTasks" class="btn secondary">Task Manager</button>
    </div>
  </nav>

  <main class="container">

    <div class="header">
      <div>
        <div class="title" id="pageTitle">الجدول الأسبوعي</div>
        <div class="sub" id="subTitle">عرض اليوم الحالي و أوقات الصلاة لبلدية أولاد موسى - بومرداس</div>
      </div>
      <div class="muted" id="dateDisplay"></div>
    </div>

    <div class="layout">

      <!-- main column -->
      <section class="day-panel" id="schedulePanel">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
          <div>
            <div style="font-weight:700; font-size:18px;" id="dayName">اليوم</div>
            <div class="muted" id="dayHint">التخطيط اليومي مفصّل حسب المدرسة والواجبات والتعلم</div>
          </div>

          <div style="display:flex; gap:8px; align-items:center;">
            <button id="prevDay" class="small-btn">السابق</button>
            <button id="nextDay" class="small-btn">التالي</button>
          </div>
        </div>

        <div class="day-switch" id="dayPills" aria-hidden="false"></div>

        <div class="cards-grid" id="cardsGrid">
          <!-- prayer card injected -->
        </div>
      </section>

      <!-- side column -->
      <aside class="side">

        <div class="tasks" id="tasksPanel">
          <h4>Task Manager</h4>
          <div class="task-input">
            <input id="newTaskInput" placeholder="أضف مهمة جديدة (مثلاً: حل واجب الرياضيات)" aria-label="new task">
            <button id="addTaskBtn" class="btn">أضف</button>
          </div>
          <div class="task-list" id="taskList"></div>
          <div class="muted" style="font-size:13px; margin-top:8px;">المهام تحفظ تلقائياً في الجهاز</div>
        </div>

        <div class="tasks" id="settingsPanel" aria-hidden="false">
          <h4>إعدادات مصغرة</h4>
          <div class="muted" style="margin-bottom:8px;">موقع الصلاة</div>
          <div style="display:flex; gap:8px;">
            <input id="cityInput" placeholder="أولاد موسى" value="Ouled Moussa" style="flex:1; padding:8px; border-radius:8px; border:1px solid rgba(255,255,255,0.03); background:transparent; color:var(--text);">
            <input id="countryInput" placeholder="Algeria" value="Algeria" style="width:120px; padding:8px; border-radius:8px; border:1px solid rgba(255,255,255,0.03); background:transparent; color:var(--text);">
          </div>
          <div style="margin-top:10px; display:flex; gap:8px;">
            <button id="updatePrayers" class="btn">تحديث أوقات الصلاة</button>
            <button id="resetTasks" class="btn secondary">مسح المهام</button>
          </div>
        </div>

      </aside>

    </div>

  </main>

  <script>
    /**********************
     * بيانات الجدول حسب اليوم
     * (الأحد=0 ... السبت=6) — نستخدم نفس الأيام حسب طلبك
     **********************/
    const weekSchedule = {
      0: { // الأحد
        name: "الأحد",
        items: [
          { title: "استيقاظ و صلاة الفجر", time: "07:00" },
          { title: "تحضير للمدرسة", time: "07:30 - 08:00" },
          { title: "دراسة / دوام (مساءً)", time: "13:00 - 17:00" },
          { title: "صلاة العصر", time: "17:00" },
          { title: "راحة و لعب", time: "17:30 - 19:00" },
          { title: "تعلم HTML - أساسيات", time: "19:30 - 21:00" },
          { title: "حل الواجبات (مراجعة قصيرة)", time: "21:00 - 21:30" },
          { title: "نوم", time: "23:00" }
        ]
      },
      1: { // الإثنين
        name: "الإثنين",
        items: [
          { title: "استيقاظ و صلاة الفجر", time: "07:00" },
          { title: "دراسة (صباحاً)", time: "09:00 - 11:00" },
          { title: "راحة + صلاة الظهر", time: "11:00 - 13:00" },
          { title: "دراسة (مساءً)", time: "13:00 - 15:00" },
          { title: "وقت فراغ / لعب", time: "15:00 - 17:00" },
          { title: "تعلم CSS - أساسيات النص و الألوان", time: "17:30 - 19:00" },
          { title: "حل الواجبات", time: "19:00 - 20:00" },
          { title: "نوم", time: "23:00" }
        ]
      },
      2: { // الثلاثاء (يوم شبه بدون دراسة لكن فيه فترات)
        name: "الثلاثاء",
        items: [
          { title: "استيقاظ و صلاة الفجر", time: "07:30" },
          { title: "دراسة خفيفة", time: "10:00 - 12:00" },
          { title: "راحة و غداء", time: "12:00 - 15:00" },
          { title: "دراسة قصيرة", time: "15:00 - 17:00" },
          { title: "راحة و لعب", time: "17:30 - 18:30" },
          { title: "مشروع صغير HTML+CSS", time: "18:30 - 20:30" },
          { title: "حل الواجبات إن وجد", time: "20:30 - 21:00" },
          { title: "نوم", time: "23:00" }
        ]
      },
      3: { // الأربعاء (حصة بدنية 8-10)
        name: "الأربعاء",
        items: [
          { title: "استيقاظ و صلاة الفجر", time: "07:00" },
          { title: "حصة بدنية", time: "08:00 - 10:00" },
          { title: "راحة و صلاة الظهر", time: "10:00 - 13:00" },
          { title: "دراسة (مساءً)", time: "13:00 - 17:00" },
          { title: "راحة", time: "17:30 - 18:30" },
          { title: "تعلم HTML - layout", time: "18:30 - 19:30" },
          { title: "حل الواجبات", time: "19:30 - 20:30" },
          { title: "نوم", time: "23:00" }
        ]
      },
      4: { // الخميس
        name: "الخميس",
        items: [
          { title: "استيقاظ و صلاة الفجر", time: "07:00" },
          { title: "دراسة (صباحاً)", time: "08:00 - 12:00" },
          { title: "غداء + صلاة الظهر", time: "12:00 - 13:00" },
          { title: "دراسة (مساءً)", time: "13:00 - 17:00" },
          { title: "راحة", time: "17:30 - 18:30" },
          { title: "مراجعة HTML + CSS", time: "18:30 - 19:30" },
          { title: "حل الواجبات", time: "19:30 - 20:30" },
          { title: "نوم", time: "23:00" }
        ]
      },
      5: { // الجمعة
        name: "الجمعة",
        items: [
          { title: "استيقاظ و صلاة الفجر", time: "08:00" },
          { title: "راحة و أعمال منزلية", time: "09:00 - 12:00" },
          { title: "صلاة الجمعة", time: "12:00 - 13:00" },
          { title: "راحة و لعب", time: "13:00 - 15:00" },
          { title: "تعلم CSS - Flexbox", time: "15:00 - 17:00" },
          { title: "راحة مسائية", time: "17:30 - 21:00" },
          { title: "نوم", time: "23:00" }
        ]
      },
      6: { // السبت
        name: "السبت",
        items: [
          { title: "استيقاظ و صلاة الفجر", time: "08:00" },
          { title: "مراجعة HTML + CSS", time: "09:00 - 11:00" },
          { title: "راحة و غداء", time: "11:00 - 13:00" },
          { title: "وقت حر و لعب", time: "13:00 - 16:00" },
          { title: "مشروع بسيط (صفحة شخصية)", time: "17:00 - 18:30" },
          { title: "نوم", time: "23:00" }
        ]
      }
    };

    // يوم اليوم والـ DOM
    const dayNames = ["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"];
    const dayPillsContainer = document.getElementById('dayPills');
    const cardsGrid = document.getElementById('cardsGrid');
    const dayNameEl = document.getElementById('dayName');
    const dateDisplay = document.getElementById('dateDisplay');

    // show/hide panels
    const schedulePanel = document.getElementById('schedulePanel');
    const tasksPanel = document.getElementById('tasksPanel');
    const showScheduleBtn = document.getElementById('showSchedule');
    const showTasksBtn = document.getElementById('showTasks');

    showScheduleBtn.addEventListener('click', ()=> { schedulePanel.style.display='block'; tasksPanel.style.display='block'; showScheduleBtn.classList.add('active'); showTasksBtn.classList.remove('active'); });
    showTasksBtn.addEventListener('click', ()=> { schedulePanel.style.display='block'; tasksPanel.style.display='block'; showTasksBtn.classList.add('active'); showScheduleBtn.classList.remove('active'); });

    // day navigation
    let currentDayIndex = (new Date()).getDay(); // 0 = Sun
    // normalize: JS getDay 0=Sunday matches our mapping
    const prevDayBtn = document.getElementById('prevDay');
    const nextDayBtn = document.getElementById('nextDay');

    prevDayBtn.addEventListener('click', ()=> {
      currentDayIndex = (currentDayIndex+6) % 7;
      renderDay(currentDayIndex);
    });
    nextDayBtn.addEventListener('click', ()=> {
      currentDayIndex = (currentDayIndex+1) % 7;
      renderDay(currentDayIndex);
    });

    function renderDayPills(selectedIndex){
      dayPillsContainer.innerHTML = '';
      for(let i=0;i<7;i++){
        const btn = document.createElement('button');
        btn.className = 'day-pill' + (i===selectedIndex ? ' current' : '');
        btn.textContent = dayNames[i];
        btn.addEventListener('click', ()=> { currentDayIndex = i; renderDay(i); });
        dayPillsContainer.appendChild(btn);
      }
    }

    function renderDay(idx){
      const dayData = weekSchedule[idx];
      dayNameEl.textContent = dayData.name;
      const today = new Date();
      dateDisplay.textContent = today.toLocaleDateString('ar-DZ', { weekday: 'long', year:'numeric', month:'long', day:'numeric' });
      renderDayPills(idx);

      // build cards
      cardsGrid.innerHTML = '';

      // prayer card (will populate times after fetching)
      const prayerCard = document.createElement('div');
      prayerCard.className = 'card prayer-card';
      prayerCard.innerHTML = '<div style="font-weight:700; font-size:16px;">أوقات الصلاة</div><div class="prayer-list" id="prayerList">...جاري التحميل</div>';
      cardsGrid.appendChild(prayerCard);

      // activity cards
      dayData.items.forEach(it => {
        const c = document.createElement('div');
        c.className = 'card';
        c.innerHTML = `<div style="display:flex; justify-content:space-between; align-items:center;"><h3>${it.title}</h3><div class="time">${it.time}</div></div><p class="muted">محدد حسب الجدول الأسبوعي</p>`;
        cardsGrid.appendChild(c);
      });

      // add an empty card for spacing/notes
      const noteCard = document.createElement('div');
      noteCard.className = 'card';
      noteCard.innerHTML = `<h3>ملاحظة</h3><p class="muted">أضف مهامك في الـ Task Manager، وحدث أوقات الصلاة عند الحاجة.</p>`;
      cardsGrid.appendChild(noteCard);

      // finally fetch prayers for the selected date (we fetch by city/country inputs)
      fetchAndRenderPrayers();
    }

    // initial render
    renderDay(currentDayIndex);

    /**********************
     * Prayer times — Aladhan API
     **********************/
    const cityInput = document.getElementById('cityInput');
    const countryInput = document.getElementById('countryInput');
    const updatePrayersBtn = document.getElementById('updatePrayers');

    updatePrayersBtn.addEventListener('click', ()=> {
      fetchAndRenderPrayers(true);
    });

    async function fetchAndRenderPrayers(force=false){
      const prayerListEl = document.getElementById('prayerList');
      if (!prayerListEl) return;
      prayerListEl.innerHTML = 'جارٍ التحديث...';

      const city = cityInput.value.trim() || 'Ouled Moussa';
      const country = countryInput.value.trim() || 'Algeria';

      // use today's date
      const date = new Date();
      const timestamp = Math.floor(date.getTime() / 1000);

      // Aladhan endpoint: timingsByCity (no API key needed)
      // method parameter left to 2 (ISNA) — تعديل إذا حبيت
      const url = `https://api.aladhan.com/v1/timingsByCity?city=${encodeURIComponent(city)}&country=${encodeURIComponent(country)}&method=2`;

      try {
        const resp = await fetch(url);
        if (!resp.ok) throw new Error('خطأ فالاستجابة');
        const data = await resp.json();
        if (data.code !== 200 && !data.data) throw new Error('لا توجد بيانات');

        const timings = data.data.timings || {};
        // filter common prayer names and format them: Fajr, Dhuhr, Asr, Maghrib, Isha
        const mapping = [
          ['Fajr','الفجر'],
          ['Dhuhr','الظهر'],
          ['Asr','العصر'],
          ['Maghrib','المغرب'],
          ['Isha','العشاء']
        ];

        prayerListEl.innerHTML = ''; // clear
        mapping.forEach(([en, ar]) => {
          const val = timings[en] || timings[ar] || '-';
          const item = document.createElement('div');
          item.className = 'prayer-item';
          item.innerHTML = `<div class="name">${ar}</div><div class="val">${val}</div>`;
          prayerListEl.appendChild(item);
        });

        // show location small
        const dayHint = document.getElementById('dayHint');
        const readable = `${city} - ${country}`;
        dayHint.textContent = 'التخطيط اليومي مفصّل حسب المدرسة والواجبات والتعلم (أوقات الصلاة لـ ' + readable + ')';

      } catch (err) {
        prayerListEl.innerHTML = '<div class="empty">فشل جلب أوقات الصلاة. تأكد من الاتصال بالإنترنت أو حدث الموقع يدوياً.</div>';
        console.warn('Prayer fetch error:', err);
      }
    }

    // fetch prayers initially
    fetchAndRenderPrayers();

    /**********************
     * Task Manager (localStorage)
     **********************/
    const taskListEl = document.getElementById('taskList');
    const newTaskInput = document.getElementById('newTaskInput');
    const addTaskBtn = document.getElementById('addTaskBtn');
    const resetTasksBtn = document.getElementById('resetTasks');

    const TASKS_KEY = 'rixel_tasks_v1';

    function loadTasks(){
      try {
        const raw = localStorage.getItem(TASKS_KEY);
        return raw ? JSON.parse(raw) : [];
      } catch(e){
        return [];
      }
    }
    function saveTasks(list){
      localStorage.setItem(TASKS_KEY, JSON.stringify(list));
    }

    function renderTasks(){
      const tasks = loadTasks();
      taskListEl.innerHTML = '';
      if (!tasks.length){
        taskListEl.innerHTML = '<div class="empty">لا توجد مهام. أضف مهمة جديدة.</div>';
        return;
      }
      tasks.forEach((t, idx) => {
        const item = document.createElement('div');
        item.className = 'task-item';
        const left = document.createElement('div'); left.className='left';
        const cb = document.createElement('input'); cb.type='checkbox'; cb.checked = !!t.done;
        cb.addEventListener('change', ()=>{
          toggleTask(idx);
        });
        const txt = document.createElement('div'); txt.className='text'; txt.textContent = t.text;
        const meta = document.createElement('div'); meta.className='meta'; meta.textContent = t.time || '';
        left.appendChild(cb);
        left.appendChild(txt);

        const right = document.createElement('div'); right.className='task-actions';
        const del = document.createElement('button'); del.className='small-btn'; del.textContent='حذف';
        del.addEventListener('click', ()=> { deleteTask(idx); });
        right.appendChild(del);

        item.appendChild(left);
        item.appendChild(right);
        taskListEl.appendChild(item);
      });
    }

    function addTask(text){
      if (!text || !text.trim()) return;
      const tasks = loadTasks();
      tasks.unshift({ text: text.trim(), done:false, time: new Date().toLocaleString('ar-DZ') });
      saveTasks(tasks);
      renderTasks();
      newTaskInput.value = '';
    }
    addTaskBtn.addEventListener('click', ()=> { addTask(newTaskInput.value); });
    newTaskInput.addEventListener('keydown', (e)=> { if (e.key === 'Enter') addTask(newTaskInput.value); });

    function toggleTask(idx){
      const tasks = loadTasks();
      if (!tasks[idx]) return;
      tasks[idx].done = !tasks[idx].done;
      saveTasks(tasks);
      renderTasks();
    }

    function deleteTask(idx){
      let tasks = loadTasks();
      tasks.splice(idx,1);
      saveTasks(tasks);
      renderTasks();
    }

    resetTasksBtn.addEventListener('click', ()=>{
      if (confirm('تم مسح كل المهام. تأكيد؟')) {
        localStorage.removeItem(TASKS_KEY);
        renderTasks();
      }
    });

    // init
    renderTasks();

    /**********************
     * small UX polish: auto-update date display every minute
     **********************/
    setInterval(()=> {
      const now = new Date();
      dateDisplay.textContent = now.toLocaleDateString('ar-DZ', { weekday: 'long', year:'numeric', month:'long', day:'numeric' });
    }, 60000);

    // keyboard shortcuts: left/right to change day
    document.addEventListener('keydown', (e)=>{
      if (e.key === 'ArrowLeft') { currentDayIndex = (currentDayIndex+6)%7; renderDay(currentDayIndex); }
      if (e.key === 'ArrowRight') { currentDayIndex = (currentDayIndex+1)%7; renderDay(currentDayIndex); }
    });

          del.textContent = 'حذف';
        del.addEventListener('click', ()=> {
          deleteTask(idx);
        });
        right.appendChild(del);

        item.appendChild(left);
        item.appendChild(right);
        taskListEl.appendChild(item);

     
    
    function addTask(){
      const text = newTaskInput.value.trim();
      if (!text) return;
      const tasks = loadTasks();
      tasks.push({ text, done:false, time: new Date().toLocaleTimeString('ar-DZ', { hour: '2-digit', minute:'2-digit' }) });
      saveTasks(tasks);
      newTaskInput.value = '';
      renderTasks();
    }

    function toggleTask(index){
      const tasks = loadTasks();
      tasks[index].done = !tasks[index].done;
      saveTasks(tasks);
      renderTasks();
    }

    function deleteTask(index){
      const tasks = loadTasks();
      tasks.splice(index,1);
      saveTasks(tasks);
      renderTasks();
    }

    function resetTasks(){
      if(confirm('هل أنت متأكد من مسح جميع المهام؟')){
        localStorage.removeItem(TASKS_KEY);
        renderTasks();
      }
    }

    addTaskBtn.addEventListener('click', addTask);
    newTaskInput.addEventListener('keypress', e=>{
      if(e.key==='Enter') addTask();
    });
    resetTasksBtn.addEventListener('click', resetTasks);

    // أول تحميل
    renderTasks();
  </script>
</body>
</html>

